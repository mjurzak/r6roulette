# AGENTS.md

## Project Overview

R6Roulette -- a Rainbow Six Siege operator randomizer web app. Users can
randomly select attackers/defenders, ban up to 2 operators per side, search,
and spin a roulette. Statically exported and deployed to GitHub Pages.

## Tech Stack

- **Frontend:** Next.js 16 (App Router), React 19, TypeScript
- **Styling:** styled-jsx (inline `<style jsx>`) + Tailwind CSS (base/reset only)
- **Data:** Static JSON files (`public/attackers.json`, `public/defenders.json`)
- **Backend utility:** Python 3.11 Selenium scraper (`backend/init_json.py`)
- **Package manager:** npm
- **Deployment:** GitHub Pages via GitHub Actions (static export to `./dist`)

## Build / Dev / Lint Commands

```bash
# install dependencies
npm install

# development server
npm run dev

# production build (static export to ./dist)
npm run build

# start production server (not used -- static export)
npm start

# lint (Next.js built-in ESLint, no custom config committed)
npm run lint
```

## Testing

No test framework is configured. There are no test files, no test runner, and
no test script in package.json. If adding tests, use Vitest (recommended for
Next.js/Vite ecosystem) or Jest.

```bash
# when tests exist, run a single test file:
# npx vitest run path/to/file.test.ts
# npx jest path/to/file.test.ts
```

## Data Generation (Python Scraper)

The operator JSON data is generated by a Selenium scraper. The `public/`
directory with `attackers.json` and `defenders.json` must exist before building.

```bash
# from the project root (requires Chrome + chromedriver)
python backend/init_json.py
```

The scraper writes to `../public/` relative to `backend/`, which resolves to
the project-root `public/` directory.

## Project Structure

```
app/
  page.tsx          # main page -- entire app UI and logic (~389 lines)
  layout.tsx        # root layout (Inter font, metadata)
  loading.tsx       # suspense loading fallback
  globals.css       # Tailwind directives + Ubisoft Sans font-face
  _app.js           # legacy Pages Router pattern (unused)
backend/
  init_json.py      # Selenium scraper for operator data
public/
  attackers.json    # generated -- not in git
  defenders.json    # generated -- not in git
next.config.mjs     # static export config, basePath for GitHub Pages
tsconfig.json        # strict mode, path alias @/* -> ./*
tailwind.config.ts   # content paths for Tailwind
```

## Code Style -- TypeScript / React

### General formatting
- **Indentation:** 2 spaces for TSX/TS files
- **Quotes:** single quotes for JS/TS strings, double quotes for JSX attributes
- **Semicolons:** used at end of statements
- **Line length:** no enforced limit, but keep lines reasonable (~100 chars)
- **Trailing commas:** not used consistently

### Imports
- `'use client'` directive first, followed by a blank line
- React hooks imported as named imports: `import { useState, useEffect } from 'react'`
- CSS imports: `import './globals.css'`
- JSON data imports: `import data from '../public/file.json'`
- Type imports use `import type` syntax: `import type { Metadata } from "next"`

### Components
- Page components use `export default function ComponentName()` syntax
- Inner/helper components use `const ComponentName = (props) => { ... }`
- Props are destructured inline: `({ bannedOperators }: { bannedOperators: Type })`
- Functional components only -- no class components

### Types
- TypeScript strict mode is enabled (`tsconfig.json`)
- Interfaces preferred over type aliases for data shapes
- Interfaces defined at module level before components
- Generic state typing: `useState<Type>(initialValue)`
- Union literal types for constrained values: `'a' | 'd'`
- `any` is used for untyped JSON data (not ideal -- prefer proper types)

### State and Effects
- All state managed via `useState` hooks
- Side effects via `useEffect` with proper dependency arrays
- Event handlers named with `handle` prefix: `handleOperatorClick`, `handleSideChange`
- Data-fetching functions named with `fetch` prefix: `fetchOperators`

### Styling
- Primary styling method: **styled-jsx** (`<style jsx>{...}</style>`)
- Tailwind CSS is imported but only used for base reset/utilities in `globals.css`
- CSS class names use kebab-case: `.random-operator`, `.banned-info`
- Inline styles via `style={{ }}` for dynamic values only

### Naming Conventions
- **Components:** PascalCase (`OperatorsComponent`, `Roulette`)
- **Functions/variables:** camelCase (`fetchOperators`, `currentColor`)
- **Data properties from JSON:** snake_case (`operator_names`, `operator_icons`)
- **CSS classes:** kebab-case (`.roulette-button`, `.search-bar`)
- **Files:** kebab-case for config, camelCase for components (Next.js convention)

### Error Handling
- try/catch around data fetching with `console.error` for logging
- No user-facing error UI -- errors are logged to console only
- Guard conditions for array bounds (e.g., `bannedOperators[side].length < 2`)

## Code Style -- Python (backend)

- **Indentation:** 4 spaces
- **Imports:** stdlib first, then third-party, separated by blank line
- **Classes:** PascalCase with `__init__` constructor, type hints on parameters
- **Error handling:** try/except with `print()` for errors, `raise Exception` for fatal
- **Strings:** double quotes for strings
- **Entry point:** `if __name__ == "__main__":` guard

## Configuration Notes

- `next.config.mjs`: static export (`output: 'export'`), production basePath `/r6roulette`
- `tsconfig.json`: strict mode, path alias `@/*` maps to project root
- Tailwind content paths include `./pages/` and `./components/` (directories don't exist yet)
- No ESLint config file committed -- `next lint` will prompt for setup on first run
- No Prettier config -- no auto-formatting enforced
- No `.env` files -- do not create or use `.env` under any circumstances

## CI/CD

GitHub Actions workflow (`.github/workflows/nextjs.yml`):
- Triggers on push to `main` + manual dispatch
- Node 20, `npm install`, `npm run build`
- Uploads `./dist` artifact, deploys to GitHub Pages
- No lint or test steps in CI

## Key Gotchas

1. The `public/` directory with JSON data files is not committed to git.
   Run `python backend/init_json.py` to generate them before building.
2. The `fs` package in dependencies is a no-op shim -- do not use Node `fs` in client code.
3. `axios` is a dependency but currently unused (API calls are commented out in `page.tsx`).
4. The app is a single-page application -- all UI logic lives in `app/page.tsx`.
5. Never commit `.env` files or use environment variable files.
